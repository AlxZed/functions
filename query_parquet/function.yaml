kind: job
metadata:
  name: query-func
  tag: ''
  hash: 45e82585092633920686d4e3131491085d003c86
  project: ''
spec:
  command: ''
  args: []
  image: mlrun/mlrun
  env:
  - name: V3IO_API
    value: ''
  - name: V3IO_USERNAME
    value: ''
  - name: V3IO_ACCESS_KEY
    value: ''
  default_handler: query_parquet
  entry_points:
    set_schema:
      name: set_schema
      doc: ''
      parameters:
      - name: self
      - name: file_path
      outputs: []
      lineno: 18
    schema_to_tuple:
      name: schema_to_tuple
      doc: ''
      parameters:
      - name: self
      outputs: []
      lineno: 22
    query_parquet:
      name: query_parquet
      doc: 'query_parquet function


        query parquet file via oresto over hive metastore'
      parameters:
      - name: context
      - name: file_path
        doc: parquet file path
      - name: hive_table_name
        doc: the name of the hive table that will be created in hive metastore
        default: hive_table_name
      outputs: []
      lineno: 33
  description: ''
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKZnJvbSBtbHJ1biBpbXBvcnQgZ2V0X29yX2NyZWF0ZV9jdHgKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHB5YXJyb3cgYXMgcGEKZnJvbSBweWFycm93LnBhcnF1ZXQgaW1wb3J0IHJlYWRfc2NoZW1hCmZyb20gcHloaXZlIGltcG9ydCBwcmVzdG8gICMgb3IgaW1wb3J0IGhpdmUKaW1wb3J0IG9zCgpjbGFzcyBQYXJxdWV0RmlsZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGxvZ2dlciwgZmlsZV9wYXRoKToKICAgICAgICBzZWxmLmxvZ2dlciA9IGxvZ2dlcgogICAgICAgIHNlbGYucGF0aCA9IGZpbGVfcGF0aAogICAgICAgIHNlbGYuc2NoZW1hID0gTm9uZQogICAgICAgIHNlbGYuc2V0X3NjaGVtYShmaWxlX3BhdGgpCgogICAgZGVmIHNldF9zY2hlbWEoc2VsZiwgZmlsZV9wYXRoKToKICAgICAgICBzY2hlbWEgPSByZWFkX3NjaGVtYShmaWxlX3BhdGgpCiAgICAgICAgc2VsZi5zY2hlbWEgPSBzY2hlbWEKCiAgICBkZWYgc2NoZW1hX3RvX3R1cGxlKHNlbGYpOgogICAgICAgIHNjaGVtYV9uYW1lcyA9IHNlbGYuc2NoZW1hLm5hbWVzCiAgICAgICAgc2NoZW1hX3R5cGVzID0gc2VsZi5zY2hlbWEudHlwZXMKICAgICAgICBzY2hlbWFfdHVwbGUgPSB0dXBsZSh6aXAoc2NoZW1hX25hbWVzLCBzY2hlbWFfdHlwZXMpKQogICAgICAgIHJldHVybiBzY2hlbWFfdHVwbGUKCgoKICAgIAoKCmRlZiBxdWVyeV9wYXJxdWV0KGNvbnRleHQsIGZpbGVfcGF0aCwgaGl2ZV90YWJsZV9uYW1lPSdoaXZlX3RhYmxlX25hbWUnKToKICAgICIiInF1ZXJ5X3BhcnF1ZXQgZnVuY3Rpb24KICAgIAogICAgcXVlcnkgcGFycXVldCBmaWxlIHZpYSBvcmVzdG8gb3ZlciBoaXZlIG1ldGFzdG9yZSAgICAKICAgIAogICAgOnBhcmFtIGZpbGVfcGF0aDogIHBhcnF1ZXQgZmlsZSBwYXRoCiAgICAKICAgIDpwYXJhbSBoaXZlX3RhYmxlX25hbWU6IHRoZSBuYW1lIG9mIHRoZSBoaXZlIHRhYmxlIHRoYXQgd2lsbCBiZSBjcmVhdGVkIGluIGhpdmUgbWV0YXN0b3JlCiAgICAiIiIKICAgIHBxdCA9IFBhcnF1ZXRGaWxlKGNvbnRleHQubG9nZ2VyLCBmaWxlX3BhdGgpCiAgICAKICAgIAoK
    commands: []
    code_origin: http://github.com/aviaiguazio/functions.git#c12dbec69f83af8d517b3c5753af42a34d67d591:query_func.ipynb
